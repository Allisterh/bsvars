# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

bsvar_cpp <- function(S, Y, X, VB, prior, starting_values) {
    .Call(`_bsvars_bsvar_cpp`, S, Y, X, VB, prior, starting_values)
}

bsvar_msh_cpp <- function(S, Y, X, prior, VB, starting_values, finiteM = TRUE, MSnotMIX = TRUE) {
    .Call(`_bsvars_bsvar_msh_cpp`, S, Y, X, prior, VB, starting_values, finiteM, MSnotMIX)
}

bsvar_sv_cpp <- function(S, Y, X, prior, VB, starting_values, sample_s_ = TRUE) {
    .Call(`_bsvars_bsvar_sv_cpp`, S, Y, X, prior, VB, starting_values, sample_s_)
}

#' @title The log of Bayes factor for the homoskedasticity hypothesis for each structural shock
#'
#' @description Computes the logarithm of Bayes factor for the homoskedasticity hypothesis 
#' for each of the structural shocks via Savage-Dickey Density Ration (SDDR).
#' The hypothesis is represented by restriction:
#' \Sexpr[results=rd, stage=build]{katex::math_to_rd("w_n = 0")}
#' The logarithm of Bayes factor for this hypothesis can be computed using the SDDR 
#' as the difference of logarithms of the marginal posterior distribution ordinate at the restriction 
#' less the marginal prior distribution ordinate at the same point:
#' \Sexpr[results=rd, stage=build]{katex::math_to_rd("log p(w_n = 0 | data) - log p(w_n = 0)")}
#' Therefore, a negative value of the difference is the evidence against 
#' homoskedasticity of the structural shock. The estimation of both elements of the difference requires 
#' numerical integration.
#' 
#' @param posterior the \code{posterior} element of the list from the estimation outcome obtained using function \code{bsvar_sv}
#' @param prior A list specifying the prior distribution. See argument \code{prior} of function \code{bsvar_sv}
#' @param Y an \code{NxT} matrix, the matrix containing \code{T} observations on \code{N} dependent time series variables
#' @param X a \code{KxT} matrix, the matrix containing \code{T} observations on \code{K = N*p+d} regressors including \code{p} lags of dependent variables and \code{d} deterministic terms
#' @param sample_s_ a logical value set to the same value as the corresponding argument of function \code{bsvar_sv}
#' 
#' @return A list of two components:
#' 
#' \code{logSDDR} an \code{N}-vector with values of the logarithm of the Bayes factors for 
#' the homoskedasticity hypothesis for each of the shocks
#' 
#' \code{components} a list of three components for the computation of the Bayes factor
#' \describe{
#'   \item{log_denominator}{an \code{N}-vector with values of the logarithm of the Bayes factor denominators}
#'   \item{log_numerator}{an \code{N}-vector with values of the logarithm of the Bayes factor numerators}
#'   \item{log_numerator_s}{an \code{NxS} matrix of the log-full conditional posterior density ordinates computed to estimate the numerator}
#' }
#' 
#' @seealso [bsvar_sv()]
#'
#' @author Tomasz Woźniak \email{wozniak.tom@pm.me}
#' 
#' @references 
#' Lütkepohl, H., Shang, F., Uzeda, L., and Woźniak, T. (2022) Partial Identification of Heteroskedastic Structural VARs: Theory and Bayesian Inference.
#'
#' @export
logSDDR_homoskedasticity <- function(posterior, prior, Y, X, sample_s_ = TRUE) {
    .Call(`_bsvars_logSDDR_homoskedasticity`, posterior, prior, Y, X, sample_s_)
}

#' @title Waggoner & Zha (2003) row signs normalisation of the posterior draws for matrix \code{B}
#'
#' @description Normalises the sign of rows of matrix \code{B} MCMC draws, 
#'  provided as the first argument \code{posterior_B}, relative to matrix
#'  \code{B_hat}, provided as the second argument of the function. The implemented
#'  procedure proposed by Waggoner, Zha (2003) normalises the MCMC output in an
#'  optimal way leading to the unimodal posterior. Only normalised MCMC output is 
#'  suitable for the computations of the posterior characteristics of the \code{B}
#'  matrix elements and their functions such as the impulse response functions and other 
#'  economically interpretable values. 
#' 
#' @param posterior_B an \code{NxNxS} array containing \code{S} draws from the posterior 
#' distribution of the \code{NxN} matrix of contemporaneous relationships \code{B}. 
#' These draws are to be normalised with respect to:
#' @param B_hat an \code{NxN} matrix specified by the user to have the desired row signs
#' 
#' @return Nothing. The normalised elements overwrite the corresponding elements of 
#' the first argument \code{posterior_B} by reference.
#' 
#' @seealso [bsvar()] [bsvar_msh()] [bsvar_sv()]
#'
#' @author Tomasz Woźniak \email{wozniak.tom@pm.me}
#' 
#' @references 
#' Waggoner, D.F., and Zha, T., (2003) Likelihood Preserving Normalization in Multiple Equation Models. 
#' \emph{Journal of Econometrics}, \bold{114}(2), 329--47, \doi{https://doi.org/10.1016/S0304-4076(03)00087-3}.
#'
#' @export
normalisation_wz2003 <- function(posterior_B, B_hat) {
    invisible(.Call(`_bsvars_normalisation_wz2003`, posterior_B, B_hat))
}

